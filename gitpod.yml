image:
  file: Dockerfile

tasks:
  - init: echo 'export PATH=$PATH:/workspace/PredictIOR_Nextflow' >> ~/.bashrc && source ~/.bashrc
  - name: Start and setup environment
    init: |
      HISTFILE=/workspace/.gitpod/cmd-0 history -r

      # Ensure Docker is started
      sudo service docker start

      # Add gitpod user to the docker group
      sudo usermod -aG docker gitpod

      # Install Nextflow
      mkdir -p ~/bin
      curl -s https://get.nextflow.io | bash
      mv nextflow ~/bin/
      chmod +x ~/bin/nextflow
      echo 'export PATH="$HOME/bin:$PATH"' >> ~/.bashrc
      source ~/.bashrc

    command: |
      newgrp docker
      /bin/bash

